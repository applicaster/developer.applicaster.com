-- WIP --

As explained in the Concept section, Zapp-pipes relies on a javascript library evaluated inside a JS bridge on both iOS and android platform. 

the current page explains in more depths the architecture of the zapp-pipes project

## Shared native features

On both native platforms, the infrastructure consists in a singleton class which holds a reference to the Javascript context in which the javascript library is evaluated. this classes are extended with helpers and other classes / methods which provide the following features : 
* a loading method, which takes your desired environment as a parameter, and a completion block to run once loading is done
* a static member in the JS loading class can be used to know whether the JSContext is evaluated and ready to use
* If set to `production` environment, the loader will perform a head request to the js bundle's url in order check if the etag has changed since the previous loading. If not, it will use the cached version. If the etag is different, the latest bundle will be fetched and cached
* a `get(String url, Callback callback)` method to actually load data via the JS lirbary
* basic `window` object polyfill
* XMLHttpRequest polyfill to allow the JS library to perform network requests (currently supports GET & POST methods, with header settings)
* a global method called `getAppData`that is used by the JS library to retrieve some data in the app

Both platform check for a boolean in the build params to toggle the use of the Zapp-Pipes project. Make sure this is set properly in your app build params when using this feature

## iOS

On iOS, the JS bridge relies on the JavaScriptCore framework.
The code can be found in ApplicasterSDK-iOS, in the customDataSources folder.

## Android

on Android, the JS bridge relies on the [LiquidCore Library v0.1.0](https://github.com/LiquidPlayer/LiquidCore/wiki/README-(v0.1.0))
The code can be found in applicaster-android-sdk, in the jspipes folder

## Javascript

The JS library itself is an ES5-compatible javascript bundle hosted on s3. The bundle is created by a packager that can be used either locally, or through a CI process. Note that a specific bundle is created for each app, to make sure each app's bundle is built only with the providers required for this app, in order to reduce bundle size and loading time.

The bundle exposes a single `zappPipes` global object which contains the `get(url, callback)` method the native apps use when retrieving data.

Bundles are created via the `zapp-pipes-packager` repo. It is a shell project which pulls the `zapp-pipes-dev-kit` repo (which contains the core library, as well as some dev & test features) and the required providers as npm dependencies. It then runs a series of scripts to configure, test, build and deploy the bundle automatically.

Check the pages about how to create a new provider and how to manually package a bundle to know more about these features